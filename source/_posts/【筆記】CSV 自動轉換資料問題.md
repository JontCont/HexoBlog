---
title: 【筆記】CSV 自動轉換資料問題
date: 2024-05-03 22:54:19
categories: 
  - 筆記 
  - 技術
description:
keyword: 'C#'
cover: 'https://png.pngtree.com/png-clipart/20190630/original/pngtree-csv-file-document-icon-png-image_4166827.jpg'
---

## 前言
最近因為專案在處理 csv 轉換過程，每個人都會遇到excel會友自動轉換問題，這邊就來分享一下我們遇到的問題。

## 一、最近 excel 近況
來源 : [微軟終於允許Excel用戶調整自動轉換功能，可以不再自動將連續字母與數字轉成日期](https://www.ithome.com.tw/news/159449)

在去年微軟宣布，Excel 將會在 2023 年 4 月之後的版本中，允許用戶調整自動轉換功能，這樣用戶就可以不再自動將連續字母與數字轉成日期。
調整方式為 [ 設定 > 資料 > 關閉自動轉換功能 ] 就可以解決。

![](/image/20240503_23-57-09.png)

但缺點就是 excel 要在 2309 版本之後才會有這個功能，所以在這之前還是要注意。

## 二、CSV 排除方式
在處理 csv 檔案時，我們可以透過以下方式來排除自動轉換問題。

### 1. 使用公式
在 Excel 中，我們可以使用公式來強制將數字轉換為文字，這樣就可以避免 Excel 的自動轉換。
```excel
="123456"
```

唯一缺點就是在.csv用記事本檢視時會多一個 `=""` 符號。


### 2. 使用單引號
在 Excel 中，我們可以在數字前加上單引號 `'` 來強制將數字轉換為文字，這樣就可以避免 Excel 的自動轉換。
```excel
'123456
```

這裡驗證過，在excel裡面如果直接下 '引號是不會被記錄在 csv裡面。如果是透過code加入有可能會直接顯示單引號在 excel 上面。